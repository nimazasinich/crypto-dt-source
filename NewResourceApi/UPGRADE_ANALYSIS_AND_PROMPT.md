# ğŸš€ ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ Ùˆ Ù¾Ø±Ø§Ù…Ù¾Øª Ø§Ø±ØªÙ‚Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Crypto Intelligence Hub

## ğŸ“Š ØªØ­Ù„ÛŒÙ„ ÙˆØ¶Ø¹ ÙØ¹Ù„ÛŒ

### âœ… Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ù¾Ø±ÙˆÚ˜Ù‡
1. **Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù‚ÙˆÛŒ**: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² FastAPI + Flask Ø¨Ø§ Docker
2. **Ù…Ù†Ø§Ø¨Ø¹ Ù…ØªÙ†ÙˆØ¹**: 50+ provider Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø±ÛŒÙ¾ØªÙˆ
3. **Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Proxy**: Ø³ÛŒØ³ØªÙ… Smart Proxy Manager Ø¨Ø±Ø§ÛŒ Ø¯ÙˆØ± Ø²Ø¯Ù† Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§
4. **WebSocket**: Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² real-time data
5. **Database**: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² SQLAlchemy Ø¨Ø±Ø§ÛŒ persistence
6. **AI/ML**: Ø§Ø¯ØºØ§Ù… Ø¨Ø§ Hugging Face models

### âš ï¸ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù Ùˆ Ù…Ø´Ú©Ù„Ø§Øª

#### 1. **Ù…Ø¯ÛŒØ±ÛŒØª Proxy Ùˆ DNS**
```python
# Ù…Ø´Ú©Ù„ ÙØ¹Ù„ÛŒ:
- Proxy Ù‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ (example.com) Ú©Ù‡ Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
- Ø¹Ø¯Ù… Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ smart DNS
- Ù†Ø¯Ø§Ø´ØªÙ† fallback strategy Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Binance Ùˆ CoinGecko
```

#### 2. **Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ**
```
- Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø§Ø³ØªØ§ØªÛŒÚ© (HTML/CSS/JS)
- Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙØ±ÛŒÙ…ÙˆØ±Ú© Ù…Ø¯Ø±Ù† (React/Vue)
- ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù…Ø­Ø¯ÙˆØ¯
- Ø¹Ø¯Ù… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ù…Ù†Ø§Ø³Ø¨
```

#### 3. **Performance Ùˆ Scalability**
```
- Ù†Ø¨ÙˆØ¯ load balancing
- Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ø§Ù…Ù„ Ø§Ø² caching
- Ù†Ø¯Ø§Ø´ØªÙ† CDN Ø¨Ø±Ø§ÛŒ static assets
```

#### 4. **Security Ùˆ Rate Limiting**
```python
# Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ:
- Ù†Ø¨ÙˆØ¯ API authentication Ù…Ù†Ø§Ø³Ø¨
- Rate limiting Ù…Ø­Ø¯ÙˆØ¯
- Ù†Ø¯Ø§Ø´ØªÙ† CORS policy Ø¯Ù‚ÛŒÙ‚
```

#### 5. **Monitoring Ùˆ Logging**
```
- Ù„Ø§Ú¯ÛŒÙ†Ú¯ Ø³Ø§Ø¯Ù‡ Ùˆ ØºÛŒØ±Ù…ØªÙ…Ø±Ú©Ø²
- Ù†Ø¨ÙˆØ¯ metrics Ùˆ analytics
- Ø¹Ø¯Ù… monitoring Ø³Ù„Ø§Ù…Øª providers
```

---

## ğŸ¯ Ù¾Ø±Ø§Ù…Ù¾Øª Ø¬Ø§Ù…Ø¹ Ø¨Ø±Ø§ÛŒ Ø§Ø±ØªÙ‚Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

### Ù…Ø±Ø­Ù„Ù‡ 1: Ø§Ø±ØªÙ‚Ø§ÛŒ Smart Proxy Manager

```
Ù…Ù† ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡ Ú©Ø±ÛŒÙ¾ØªÙˆ Ø¯Ø§Ø±Ù… Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ø² proxy Ùˆ DNS Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Binance Ùˆ CoinGecko Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù‡ (Ø§ÛŒÙ† APIÙ‡Ø§ Ø¯Ø± Ø¨Ø±Ø®ÛŒ Ú©Ø´ÙˆØ±Ù‡Ø§ ÙÛŒÙ„ØªØ± Ù‡Ø³ØªÙ†Ø¯).

**Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§:**

1. **Smart Proxy System** Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ±:
   - Ø§Ø¯ØºØ§Ù… Ø¨Ø§ free proxy providers Ù…Ø«Ù„ ProxyScrapeØŒ Free-Proxy-List
   - Auto-refresh Ùˆ validation Ù¾Ø±ÙˆÚ©Ø³ÛŒâ€ŒÙ‡Ø§ Ù‡Ø± 5 Ø¯Ù‚ÛŒÙ‚Ù‡
   - Health check Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ proxies
   - Load balancing Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨ÛŒÙ† proxies
   - Fallback Ø¨Ù‡ direct connection Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø¯Ø³ØªØ±Ø³ÛŒ proxy

2. **Dynamic DNS Resolution**:
   - Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² DoH (DNS over HTTPS) Ø¨Ø§ Cloudflare/Google
   - DNS caching Ø¨Ø±Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
   - Fallback DNS servers
   - Automatic retry Ø¨Ø§ DNS Ù…Ø®ØªÙ„Ù

3. **Provider-Specific Routing**:
   - ØªØ´Ø®ÛŒØµ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© Ù†ÛŒØ§Ø² Ø¨Ù‡ proxy (Ø¨Ø±Ø§ÛŒ Binance Ùˆ CoinGecko)
   - Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ø±Ø§ÛŒ provider Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
   - Configurable routing rules

**Ú©Ø¯ÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ø§Ø¯Ù‡ Ø¨Ø´Ù‡:**
- `/core/smart_proxy_manager.py` - Ø³ÛŒØ³ØªÙ… ÙØ¹Ù„ÛŒ Ù†Ø§Ù‚Øµ Ø§Ø³Øª
- Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø¯ØºØ§Ù… ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ proxy providers
- Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ DNS over HTTPS
- Ø§ÙØ²ÙˆØ¯Ù† retry logic Ùˆ circuit breaker pattern

**Ø®Ø±ÙˆØ¬ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**
Ú©Ø¯ Ú©Ø§Ù…Ù„ Ùˆ Ø¹Ù…Ù„ÛŒØ§ØªÛŒ Ø¨Ø±Ø§ÛŒ `smart_proxy_manager.py` Ú©Ù‡:
- Ø§Ø² API Ù‡Ø§ÛŒ Ø±Ø§ÛŒÚ¯Ø§Ù† proxy Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ø¯
- Health check Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
- Load balancing Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡Ø¯
- Logging Ùˆ metrics Ú©Ø§Ù…Ù„ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
```

---

### Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ø±ØªÙ‚Ø§ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ù‡ React/Next.js

```
Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ ÙØ¹Ù„ÛŒ Ù…Ù† HTML/CSS/JS Ø³Ø§Ø¯Ù‡ Ø§Ø³Øª. Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù… Ø¢Ù† Ø±Ø§ Ø¨Ù‡ ÛŒÚ© Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù…Ø¯Ø±Ù† React/Next.js Ø§Ø±ØªÙ‚Ø§ Ø¯Ù‡Ù….

**Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ UI/UX:**

1. **Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§ØµÙ„ÛŒ** Ø´Ø§Ù…Ù„:
   - Real-time price ticker Ø¨Ø±Ø§ÛŒ top 20 coins
   - Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ TradingView/Recharts Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ OHLC
   - News feed Ø¨Ø§ ÙÛŒÙ„ØªØ± sentiment
   - Provider health status
   - Search Ùˆ filter Ù¾ÛŒØ´Ø±ÙØªÙ‡

2. **ØµÙØ­Ù‡ ØªØ­Ù„ÛŒÙ„** Ø¨Ø§:
   - Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ (RSI, MACD, BB)
   - On-chain metrics
   - Social sentiment analysis
   - AI-powered predictions

3. **ØµÙØ­Ù‡ Providers** Ø¨Ø±Ø§ÛŒ:
   - Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª Ù‡Ù…Ù‡ providers
   - Test connectivity
   - Enable/disable providers
   - Ù†Ù…Ø§ÛŒØ´ rate limits Ùˆ usage

4. **ØªÙ… Ø¯Ø§Ø±Ú©/Ù„Ø§ÛŒØª** Ø¨Ø§ Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¯Ø±Ù† Glassmorphism

**Ø§Ø³ØªÚ© ÙÙ†ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:**
```typescript
// Tech Stack
{
  "framework": "Next.js 14 (App Router)",
  "ui": "Shadcn/ui + Tailwind CSS",
  "charts": "Recharts + TradingView Lightweight Charts",
  "state": "Zustand",
  "api": "SWR for data fetching",
  "websocket": "Socket.io-client",
  "icons": "Lucide React"
}
```

**Ø®Ø±ÙˆØ¬ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**
Ø³Ø§Ø®ØªØ§Ø± Ú©Ø§Ù…Ù„ Ù¾Ø±ÙˆÚ˜Ù‡ Next.js Ø´Ø§Ù…Ù„:
- Component structure
- API routes integration Ø¨Ø§ FastAPI backend
- Real-time WebSocket integration
- Responsive design
- Dark/Light theme
- Persian RTL support (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²)
```

---

### Ù…Ø±Ø­Ù„Ù‡ 3: Ø¨Ù‡Ø¨ÙˆØ¯ System Architecture

```
Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù… Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ… Ø±Ø§ Ø¨Ù‡ÛŒÙ†Ù‡ Ú©Ù†Ù… ØªØ§ scalable Ùˆ maintainable Ø¨Ø§Ø´Ø¯.

**Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**

1. **Caching Strategy**:
```python
# Redis Ø¨Ø±Ø§ÛŒ caching
cache_config = {
    "price_data": "60 seconds TTL",
    "ohlcv_data": "5 minutes TTL",
    "news": "10 minutes TTL",
    "provider_health": "30 seconds TTL"
}
```

2. **Rate Limiting** Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² `slowapi`:
```python
# Per-endpoint rate limits
rate_limits = {
    "/api/prices": "100/minute",
    "/api/ohlcv": "50/minute",
    "/api/news": "30/minute",
    "/ws/*": "No limit (WebSocket)"
}
```

3. **Background Workers** Ø¨Ø±Ø§ÛŒ:
- Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ OHLCV Ù‡Ø± 1 Ø¯Ù‚ÛŒÙ‚Ù‡
- Scraping news Ù‡Ø± 5 Ø¯Ù‚ÛŒÙ‚Ù‡
- Provider health checks Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
- Database cleanup Ù‡Ø± 24 Ø³Ø§Ø¹Øª

4. **Error Handling & Resilience**:
```python
# Circuit breaker pattern
from circuitbreaker import circuit

@circuit(failure_threshold=5, recovery_timeout=60)
async def fetch_from_provider(provider_name: str):
    # Implementation with retry logic
    pass
```

**Ø®Ø±ÙˆØ¬ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**
- Ú©Ø¯ Ú©Ø§Ù…Ù„ Ø¨Ø±Ø§ÛŒ workers Ø¨Ø§ APScheduler/Celery
- Redis integration Ø¨Ø±Ø§ÛŒ caching
- Circuit breaker implementation
- Comprehensive error handling
```

---

### Ù…Ø±Ø­Ù„Ù‡ 4: Monitoring Ùˆ Observability

```
Ù†ÛŒØ§Ø² Ø¨Ù‡ ÛŒÚ© Ø³ÛŒØ³ØªÙ… Ø¬Ø§Ù…Ø¹ monitoring Ø¯Ø§Ø±Ù….

**Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§:**

1. **Metrics Collection**:
```python
# Metrics to track
metrics = {
    "api_requests_total": "Counter",
    "api_response_time": "Histogram",
    "provider_requests": "Counter by provider",
    "provider_failures": "Counter",
    "cache_hits": "Counter",
    "active_websocket_connections": "Gauge"
}
```

2. **Logging Ø¨Ø§ Structured Logs**:
```python
import structlog

logger = structlog.get_logger()
logger.info("provider_request", 
    provider="binance", 
    endpoint="/api/v3/ticker", 
    duration_ms=150,
    status="success"
)
```

3. **Health Checks**:
```python
@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "providers": {
            "binance": "ok",
            "coingecko": "ok",
            ...
        },
        "database": "connected",
        "cache": "connected",
        "uptime": "2d 5h 30m"
    }
```

**Ø®Ø±ÙˆØ¬ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**
- Ú©Ø¯ monitoring Ø¨Ø§ Prometheus metrics
- Structured logging setup
- Health check endpoints
- Dashboard template Ø¨Ø±Ø§ÛŒ Grafana (optional)
```

---

### Ù…Ø±Ø­Ù„Ù‡ 5: Testing Ùˆ Documentation

```
Ù†ÛŒØ§Ø² Ø¨Ù‡ test coverage Ùˆ documentation Ø¬Ø§Ù…Ø¹ Ø¯Ø§Ø±Ù….

**Testing Requirements:**

1. **Unit Tests** Ø¨Ø±Ø§ÛŒ:
```python
# Test examples
def test_proxy_manager():
    """Test proxy rotation and health checks"""
    pass

def test_data_collectors():
    """Test each provider's data collection"""
    pass

def test_api_endpoints():
    """Test all FastAPI endpoints"""
    pass
```

2. **Integration Tests**:
```python
async def test_end_to_end_flow():
    """Test complete data flow from provider to API"""
    pass
```

3. **Load Testing** Ø¨Ø§ locust:
```python
from locust import HttpUser, task

class CryptoAPIUser(HttpUser):
    @task
    def get_prices(self):
        self.client.get("/api/prices")
```

**Documentation:**
- API documentation Ø¨Ø§ OpenAPI/Swagger
- Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø¯Ø± Hugging Face Spaces
- Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡
- Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø¯Ù‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² API

**Ø®Ø±ÙˆØ¬ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**
- Test suite Ú©Ø§Ù…Ù„ Ø¨Ø§ pytest
- Load testing scripts
- Comprehensive documentation
```

---

## ğŸ“‹ Priority List Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

### High Priority (Ø­ÛŒØ§ØªÛŒ)
1. âœ… Ø§ØµÙ„Ø§Ø­ Smart Proxy Manager Ø¨Ø±Ø§ÛŒ Binance/CoinGecko
2. âœ… Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ DNS over HTTPS
3. âœ… Ø§ÙØ²ÙˆØ¯Ù† Caching Ø¨Ø§ Redis
4. âœ… Ø¨Ù‡Ø¨ÙˆØ¯ Error Handling

### Medium Priority (Ù…Ù‡Ù…)
5. âš¡ Ø§Ø±ØªÙ‚Ø§ÛŒ UI Ø¨Ù‡ React/Next.js
6. âš¡ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Background Workers
7. âš¡ Ø§ÙØ²ÙˆØ¯Ù† Monitoring Ùˆ Metrics
8. âš¡ Rate Limiting Ù¾ÛŒØ´Ø±ÙØªÙ‡

### Low Priority (Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ø§Ù…Ø§ Ù…ÙÛŒØ¯)
9. ğŸ“ Testing Suite
10. ğŸ“ Documentation
11. ğŸ“ Load Testing
12. ğŸ“ CI/CD Pipeline

---

## ğŸ”§ Ú©Ø¯Ù‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹

### Ù†Ù…ÙˆÙ†Ù‡ Smart Proxy Manager Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡:

```python
"""
Smart Proxy Manager v2.0
Ø¨Ø§ Ø§Ø¯ØºØ§Ù… ÙˆØ§Ù‚Ø¹ÛŒ proxy providers Ùˆ DNS over HTTPS
"""

import aiohttp
import asyncio
from typing import List, Optional
from datetime import datetime, timedelta
import logging

logger = logging.getLogger(__name__)


class ProxyProvider:
    """Base class for proxy providers"""
    
    async def fetch_proxies(self) -> List[str]:
        """Fetch proxy list from provider"""
        raise NotImplementedError


class ProxyScrapeProvider(ProxyProvider):
    """Free proxy provider: ProxyScrape.com"""
    
    BASE_URL = "https://api.proxyscrape.com/v2/"
    
    async def fetch_proxies(self) -> List[str]:
        params = {
            "request": "displayproxies",
            "protocol": "http",
            "timeout": "10000",
            "country": "all",
            "ssl": "all",
            "anonymity": "elite"
        }
        
        async with aiohttp.ClientSession() as session:
            async with session.get(self.BASE_URL, params=params) as resp:
                text = await resp.text()
                proxies = [p.strip() for p in text.split('\n') if p.strip()]
                logger.info(f"âœ… Fetched {len(proxies)} proxies from ProxyScrape")
                return proxies


class FreeProxyListProvider(ProxyProvider):
    """Scraper for free-proxy-list.net"""
    
    async def fetch_proxies(self) -> List[str]:
        # Implementation for scraping free-proxy-list.net
        # Use BeautifulSoup or similar
        pass


class DNSOverHTTPS:
    """DNS over HTTPS implementation"""
    
    CLOUDFLARE_DOH = "https://cloudflare-dns.com/dns-query"
    GOOGLE_DOH = "https://dns.google/resolve"
    
    async def resolve(self, hostname: str, use_provider: str = "cloudflare") -> Optional[str]:
        """Resolve hostname using DoH"""
        
        url = self.CLOUDFLARE_DOH if use_provider == "cloudflare" else self.GOOGLE_DOH
        
        params = {
            "name": hostname,
            "type": "A"
        }
        
        headers = {
            "accept": "application/dns-json"
        }
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.get(url, params=params, headers=headers) as resp:
                    data = await resp.json()
                    
                    if "Answer" in data and len(data["Answer"]) > 0:
                        ip = data["Answer"][0]["data"]
                        logger.info(f"ğŸ” Resolved {hostname} -> {ip} via {use_provider}")
                        return ip
                    
                    logger.warning(f"âš ï¸ No DNS answer for {hostname}")
                    return None
        
        except Exception as e:
            logger.error(f"âŒ DoH resolution failed: {e}")
            return None


class SmartProxyManagerV2:
    """Enhanced Smart Proxy Manager"""
    
    def __init__(self):
        self.proxy_providers = [
            ProxyScrapeProvider(),
            # FreeProxyListProvider(),
        ]
        
        self.doh = DNSOverHTTPS()
        self.proxies: List[dict] = []
        self.last_refresh = None
        self.refresh_interval = timedelta(minutes=5)
        
        # Providers that need proxy/DNS
        self.restricted_providers = ["binance", "coingecko"]
    
    async def initialize(self):
        """Initialize and fetch initial proxy list"""
        await self.refresh_proxies()
    
    async def refresh_proxies(self):
        """Refresh proxy list from all providers"""
        logger.info("ğŸ”„ Refreshing proxy list...")
        
        all_proxies = []
        for provider in self.proxy_providers:
            try:
                proxies = await provider.fetch_proxies()
                all_proxies.extend(proxies)
            except Exception as e:
                logger.error(f"Failed to fetch from provider: {e}")
        
        # Test proxies and keep working ones
        working_proxies = await self._test_proxies(all_proxies[:20])  # Test first 20
        
        self.proxies = [
            {
                "url": proxy,
                "tested_at": datetime.now(),
                "success_count": 0,
                "fail_count": 0
            }
            for proxy in working_proxies
        ]
        
        self.last_refresh = datetime.now()
        logger.info(f"âœ… Proxy list refreshed: {len(self.proxies)} working proxies")
    
    async def _test_proxies(self, proxy_list: List[str]) -> List[str]:
        """Test proxies and return working ones"""
        working = []
        
        async def test_proxy(proxy: str):
            try:
                async with aiohttp.ClientSession() as session:
                    async with session.get(
                        "https://httpbin.org/ip",
                        proxy=f"http://{proxy}",
                        timeout=aiohttp.ClientTimeout(total=5)
                    ) as resp:
                        if resp.status == 200:
                            working.append(proxy)
            except:
                pass
        
        await asyncio.gather(*[test_proxy(p) for p in proxy_list], return_exceptions=True)
        return working
    
    async def get_proxy_for_provider(self, provider_name: str) -> Optional[str]:
        """Get proxy if needed for provider"""
        
        # Check if provider needs proxy
        if provider_name.lower() not in self.restricted_providers:
            return None  # Direct connection
        
        # Refresh if needed
        if not self.proxies or (datetime.now() - self.last_refresh) > self.refresh_interval:
            await self.refresh_proxies()
        
        if not self.proxies:
            logger.warning("âš ï¸ No working proxies available!")
            return None
        
        # Get best proxy (least failures)
        best_proxy = min(self.proxies, key=lambda p: p['fail_count'])
        return f"http://{best_proxy['url']}"
    
    async def resolve_hostname(self, hostname: str) -> Optional[str]:
        """Resolve hostname using DoH"""
        return await self.doh.resolve(hostname)


# Global instance
proxy_manager = SmartProxyManagerV2()
```

### Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Collectors:

```python
async def fetch_binance_data(symbol: str):
    """Fetch data from Binance with proxy support"""
    
    # Get proxy
    proxy = await proxy_manager.get_proxy_for_provider("binance")
    
    # Resolve hostname if needed
    # ip = await proxy_manager.resolve_hostname("api.binance.com")
    
    url = f"https://api.binance.com/api/v3/ticker/24hr"
    params = {"symbol": symbol}
    
    async with aiohttp.ClientSession() as session:
        try:
            async with session.get(
                url,
                params=params,
                proxy=proxy,  # Will be None for non-restricted providers
                timeout=aiohttp.ClientTimeout(total=10)
            ) as resp:
                return await resp.json()
        
        except Exception as e:
            logger.error(f"Binance fetch failed: {e}")
            # Fallback or retry logic
            return None
```

---

## ğŸ“¦ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆÙ†Ø¯

1. **`/core/smart_proxy_manager.py`** - Ø§ÙˆÙ„ÙˆÛŒØª 1
2. **`/workers/market_data_worker.py`** - Ø§Ø¯ØºØ§Ù… Ø¨Ø§ proxy manager
3. **`/workers/ohlc_data_worker.py`** - Ø§Ø¯ØºØ§Ù… Ø¨Ø§ proxy manager
4. **`/static/*`** - Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†ÛŒ Ø¨Ø§ React/Next.js
5. **`/api/endpoints.py`** - Ø§ÙØ²ÙˆØ¯Ù† rate limiting Ùˆ caching
6. **`/monitoring/health_checker.py`** - Ø¨Ù‡Ø¨ÙˆØ¯ health checks
7. **`requirements.txt`** - Ø§ÙØ²ÙˆØ¯Ù† dependencies Ø¬Ø¯ÛŒØ¯

---

## ğŸ¨ Ù†Ù…ÙˆÙ†Ù‡ Component React Ø¨Ø±Ø§ÛŒ Dashboard

```typescript
// components/PriceTicker.tsx
'use client'

import { useEffect, useState } from 'react'
import { Card } from '@/components/ui/card'

interface CoinPrice {
  symbol: string
  price: number
  change24h: number
}

export function PriceTicker() {
  const [prices, setPrices] = useState<CoinPrice[]>([])
  
  useEffect(() => {
    // WebSocket connection
    const ws = new WebSocket('ws://localhost:7860/ws/prices')
    
    ws.onmessage = (event) => {
      const data = JSON.parse(event.data)
      setPrices(data.prices)
    }
    
    return () => ws.close()
  }, [])
  
  return (
    <div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
      {prices.map((coin) => (
        <Card key={coin.symbol} className="p-4">
          <div className="flex items-center justify-between">
            <span className="font-bold">{coin.symbol}</span>
            <span className={coin.change24h >= 0 ? 'text-green-500' : 'text-red-500'}>
              {coin.change24h.toFixed(2)}%
            </span>
          </div>
          <div className="text-2xl font-bold mt-2">
            ${coin.price.toLocaleString()}
          </div>
        </Card>
      ))}
    </div>
  )
}
```

---

## ğŸš€ Ø¯Ø³ØªÙˆØ± Ø§Ù„Ø¹Ù…Ù„ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø¯Ø± Hugging Face Spaces

```bash
# 1. Clone Ùˆ setup
git clone <your-repo>
cd crypto-intelligence-hub

# 2. Install dependencies
pip install -r requirements.txt

# 3. Set environment variables
export HF_API_TOKEN="your_token"
export REDIS_URL="redis://localhost:6379"

# 4. Run with Docker
docker-compose up -d

# 5. Access
# API: http://localhost:7860
# Docs: http://localhost:7860/docs
```

---

## ğŸ“ Ø³ÙˆØ§Ù„Ø§Øª Ù…ØªØ¯Ø§ÙˆÙ„

### Ú†Ø·ÙˆØ± Binance Ùˆ CoinGecko Ø±Ùˆ Ø¨Ø¯ÙˆÙ† proxy ØªØ³Øª Ú©Ù†Ù…ØŸ
```python
# Ø¯Ø± config.py ÛŒØ§ .env
RESTRICTED_PROVIDERS = []  # Empty list = no proxy needed
```

### Ú†Ø·ÙˆØ± provider Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†Ù…ØŸ
```python
# Ø¯Ø± backend/providers/new_providers_registry.py
"new_provider": ProviderInfo(
    id="new_provider",
    name="New Provider",
    type=ProviderType.OHLCV.value,
    url="https://api.newprovider.com",
    ...
)
```

---

## ğŸ¯ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ

Ø§ÛŒÙ† Ù¾Ø±Ø§Ù…Ù¾Øª Ø¬Ø§Ù…Ø¹ Ø´Ø§Ù…Ù„:
- âœ… ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„ ÙˆØ¶Ø¹ Ù…ÙˆØ¬ÙˆØ¯
- âœ… Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù
- âœ… Ù¾Ø±Ø§Ù…Ù¾Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ù‚ÛŒÙ‚ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¨Ø®Ø´
- âœ… Ú©Ø¯Ù‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡
- âœ… Priority list ÙˆØ§Ø¶Ø­
- âœ… Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ

Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ù¾Ø±Ø§Ù…Ù¾Øªâ€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ú¯Ø§Ù…â€ŒØ¨Ù‡â€ŒÚ¯Ø§Ù… Ø§Ø±ØªÙ‚Ø§ Ø¯Ù‡ÛŒØ¯!
